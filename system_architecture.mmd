flowchart TD
    %% User Interface Layer
    User[ğŸ‘¤ User] --> Login[ğŸ” Login Form]
    Login --> AuthService[ğŸ”‘ Authentication Service]
    
    %% Authentication & JWT
    AuthService --> JWT{JWT Token<br/>Generation}
    JWT -->|Valid Credentials| TokenIssued[âœ… JWT Token Issued]
    JWT -->|Invalid Credentials| AuthFailed[âŒ Authentication Failed]
    TokenIssued --> Frontend[ğŸ–¥ï¸ Frontend Application]
    
    %% Security Layers
    Frontend --> RateLimit[ğŸ›¡ï¸ Rate Limiter<br/>Security Layer]
    RateLimit -->|Requests Under Limit| APIGateway[ğŸšª API Gateway]
    RateLimit -->|Too Many Requests| RateLimited[ğŸš« Rate Limited]
    
    APIGateway --> JWTValidation[ğŸ” JWT Validation<br/>Middleware]
    JWTValidation -->|Valid Token| RBACCheck[ğŸ”’ RBAC Middleware<br/>Role-Based Access]
    JWTValidation -->|Invalid Token| Unauthorized[ğŸš« Unauthorized]
    
    %% Backend Services Layer
    RBACCheck -->|Authorized| BackendServices[âš™ï¸ Backend Services]
    RBACCheck -->|Insufficient Permissions| Forbidden[ğŸš« Forbidden]
    
    BackendServices --> UserService[ğŸ‘¥ User Service]
    BackendServices --> DataService[ğŸ“Š Data Service]
    BackendServices --> ReportService[ğŸ“ˆ Report Service]
    BackendServices --> NotificationService[ğŸ”” Notification Service]
    
    %% Database Layer
    UserService --> UserDB[(ğŸ‘¥ User Database)]
    DataService --> MainDB[(ğŸ“Š Main Database)]
    ReportService --> ReportDB[(ğŸ“ˆ Report Database)]
    
    %% Bidirectional Database Operations
    UserDB <--> UserService
    MainDB <--> DataService
    ReportDB <--> ReportService
    
    %% WebSocket Layer
    BackendServices --> WSGateway[ğŸ”Œ WebSocket Gateway]
    WSGateway --> WSAuth[ğŸ” WS Authentication]
    WSAuth -->|Authenticated| WSConnections[ğŸ“¡ Active WebSocket<br/>Connections]
    WSConnections <--> RealTimeUpdates[âš¡ Real-time Updates]
    
    %% External APIs
    DataService --> ExternalAPIs[ğŸŒ External APIs]
    ExternalAPIs --> ThirdPartyAPI1[ğŸ“¡ Payment API]
    ExternalAPIs --> ThirdPartyAPI2[ğŸ“¡ Analytics API]
    ExternalAPIs --> ThirdPartyAPI3[ğŸ“¡ Integration API]
    
    %% Reporting & Export
    ReportService --> ReportGenerator[ğŸ“‹ Report Generator]
    ReportGenerator --> ExportFormats{ğŸ“„ Export Formats}
    ExportFormats --> PDFExport[ğŸ“• PDF Export]
    ExportFormats --> CSVExport[ğŸ“Š CSV Export]
    ExportFormats --> JSONExport[ğŸ“ JSON Export]
    ExportFormats --> XMLExport[ğŸ“„ XML Export]
    
    %% Logging and Monitoring
    RateLimit --> SecurityLog[ğŸ“ Security Logs]
    RBACCheck --> AuditLog[ğŸ“‹ Audit Logs]
    BackendServices --> AppLog[ğŸ“Š Application Logs]
    
    %% Styling for Security Layers
    classDef securityLayer fill:#ff6b6b,stroke:#d63031,stroke-width:3px,color:#fff
    classDef authLayer fill:#74b9ff,stroke:#0984e3,stroke-width:2px,color:#fff
    classDef serviceLayer fill:#55a3ff,stroke:#2d3436,stroke-width:2px,color:#fff
    classDef dataLayer fill:#00b894,stroke:#00a085,stroke-width:2px,color:#fff
    classDef exportLayer fill:#fdcb6e,stroke:#e17055,stroke-width:2px,color:#000
    
    %% Apply styles
    class RateLimit,RBACCheck,WSAuth,SecurityLog,AuditLog securityLayer
    class AuthService,JWT,JWTValidation authLayer
    class BackendServices,UserService,DataService,ReportService,NotificationService serviceLayer
    class UserDB,MainDB,ReportDB dataLayer
    class ReportGenerator,PDFExport,CSVExport,JSONExport,XMLExport exportLayer
